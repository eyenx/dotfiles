#!/bin/bash

# taken from https://github.com/llaine/cmdfm
CLIENTID=2cd0c4a7a6e5992167a4b09460d85ece
# cmdfm api
APIURL="https://cmd.fm/api/tracks/search/"
# test chosen genre
test -z $1 && echo -e "Please select a genre\nexample: cmdfm minimal" && exit 1
GENRE=$1
# play
while : 
    do  STREAMURL=`curl -sk ${APIURL}?genre=${GENRE}\&limit=1 |  sed 's/.*stream_url\":\"\(http.*stream\)\",.*/\1/g'`
    mplayer -quiet -nocache "${STREAMURL}?client_id=${CLIENTID}" &>/dev/null 
done

