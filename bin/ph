#!/bin/bash

# linphone helper

ph=linphonecsh
tel=/home/eye/work/cloud/Home/notes/tel.csv

case $1 in 
  call)
    num=`grep -i $2 $tel | awk -F\# '{print $3}'`
    $0 dial $num
    ;;
  dial)
    $ph dial $2
    ;;
  answer)
    $ph generic answer
    ;;
  hangup)
    $ph generic terminate
    ;;
  status)
    $ph status register
    ;;
  pause)
    $ph generic pause
    ;;
  resume)
    $ph generic resume
    ;;
  calls)
    $ph generic calls
    ;;
  history)
    $ph generic call-logs
    ;;
  transfer)
    $ph generic "transfer $2 --to-call $3"
    ;;
  notify)
    while :
    do incoming=`$ph generic calls | grep Incoming | cut -d "|" -f2`
      if [[ -z $incoming ]]
      then
       continue
      else
        notify-send "Call from $incoming"
        sleep 5
      fi
      sleep .5
    done
    ;;
  *)
    echo "- USAGE -"
    echo "call <name>"
    echo "dial <nr>"
    echo "answer/hangup"
    echo "status"
    echo "pause/resume"
    echo "calls/history"
    echo "transfer"
    exit 1
    ;;
 esac
